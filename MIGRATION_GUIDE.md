# 🚀 多项目博主管理系统 - Supabase 迁移指南

## 📋 概述

本指南将帮助您将多项目博主管理系统从本地 SQLite/LocalStorage 迁移到 Supabase 云数据库。

## 🎯 迁移优势

| ✅ 优势 | 说明 |
|--------|------|
| 🌐 多设备同步 | 支持在不同设备间实时同步数据 |
| 📊 云端备份 | 数据安全存储在云端，永不丢失 |
| 🔒 权限管理 | 基于 Supabase 的安全权限控制 |
| 📈 可扩展性 | 支持未来功能扩展和多用户协作 |
| 🔄 实时更新 | 数据变更实时同步到所有设备 |

## 🏗️ 数据库架构

### 现有 master_ 表（餐厅管理系统）
- `master_brand` - 品牌表
- `master_restaurant` - 门店表
- `master_employee` - 员工表
- `master_role` - 角色表

### 新增 kol_ 表（博主管理系统）
- `kol_project_groups` - 项目集表
- `kol_projects` - 项目表
- `kol_bloggers` - 博主表
- `kol_campaigns` - 营销活动表
- `kol_blogger_campaigns` - 博主活动关联表
- `kol_analytics` - 数据分析表
- `kol_shares` - 分享表

## 📦 迁移步骤

### 步骤 1: 备份本地数据

1. 打开现有的多项目博主管理系统
2. 按 `F12` 打开开发者工具
3. 在控制台中运行以下代码：

```javascript
// 复制 backup-local-data.js 的内容并执行
// 或者直接访问脚本文件内容
```

4. 备份文件将自动下载到本地

### 步骤 2: 数据迁移到 Supabase

1. 继续在浏览器控制台中运行：

```javascript
// 复制 migrate-to-supabase.js 的内容并执行
```

2. 按照提示确认迁移操作
3. 等待迁移完成
4. 验证迁移结果

### 步骤 3: 使用新版本应用

1. 安装新构建的 DMG 文件
2. 启动应用（已自动配置为使用 Supabase）
3. 验证数据完整性

## 🛠️ 工具脚本

### 1. 备份脚本 (`backup-local-data.js`)
- **用途**: 备份当前本地数据
- **输出**: JSON 格式的备份文件
- **包含**: 所有项目集、项目、博主数据

### 2. 迁移脚本 (`migrate-to-supabase.js`)
- **用途**: 将本地数据迁移到 Supabase
- **功能**:
  - 自动转换数据格式
  - 批量插入到云端
  - 实时进度显示
  - 错误处理和重试

### 3. 恢复脚本 (`restore-local-data.js`)
- **用途**: 从备份文件恢复本地数据
- **功能**:
  - 自动备份当前数据
  - 验证备份文件格式
  - 安全恢复数据

## 🔧 配置信息

### Supabase 配置
- **项目 ID**: `wdpeoyugsxqnpwwtkqsl`
- **URL**: `https://wdpeoyugsxqnpwwtkqsl.supabase.co`
- **状态**: 已配置完成，所有 kol_ 表已创建

### 应用配置
应用已自动配置连接到 Supabase，无需额外配置。

## ⚠️ 注意事项

### 迁移前
1. **务必备份**: 迁移前必须先备份本地数据
2. **网络连接**: 确保网络连接稳定
3. **关闭应用**: 迁移过程中请关闭其他设备上的应用

### 迁移中
1. **不要关闭页面**: 迁移过程中不要关闭浏览器标签页
2. **耐心等待**: 根据数据量大小，迁移可能需要几分钟时间
3. **错误处理**: 如遇错误，记录错误信息并重新尝试

### 迁移后
1. **验证数据**: 检查所有数据是否正确迁移
2. **测试功能**: 测试应用的各项功能是否正常
3. **保留备份**: 建议保留本地备份文件至少一周

## 🔄 回滚方案

如果迁移后遇到问题，可以按以下步骤回滚：

1. **停止使用新版本应用**
2. **安装旧版本应用**（如有备份）
3. **使用恢复脚本**恢复本地数据
4. **联系技术支持**

## 📞 技术支持

如遇到迁移问题，请提供以下信息：

1. 错误截图或错误信息
2. 备份文件（如有问题）
3. 浏览器控制台日志
4. 操作步骤描述

## 🎉 迁移完成

迁移成功后，您将享受到：

- ✅ 数据实时同步
- ✅ 多设备访问
- ✅ 自动云端备份
- ✅ 更好的性能体验
- ✅ 未来功能更新

---

**祝您迁移顺利！** 🚀